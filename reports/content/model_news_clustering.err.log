Traceback (most recent call last):
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/andres-campos/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
label_cluster = 1
print(f"Cluster con label: {label_cluster}\nNoticias de la muestra:\n")
news_summary = get_text_sample_by_cluster(label_cluster, 15)
print("\nRespuesta LLM:\n")
print(get_topic_in_cluster(news_summary))
------------------

----- stdout -----
Cluster con label: 1
Noticias de la muestra:

Noticia 1
Un grupo delincuencial conocido como 'Los Gotikas', que operaba en Boyacá y se dedicaba a la usura, fue desarticulado por la Policía Metropolitana de Tunja y la Fiscalía General de la Nación. Capturadas 10 personas, con ganancias ilícitas de 2.500 millones de pesos anuales. Las víctimas eran amedrentadas si no pagaban a tiempo. Se incautaron bienes y se impusieron medidas cautelares sobre cuentas bancarias. Autoridades recomiendan usar líneas oficiales de crédito para evitar estafas.

Noticia 2
Un atentado con explosivos contra una patrulla militar en Algeciras, Huila, resultó en dos heridos estables tras ser trasladados a Neiva. Las disidencias de las Farc, lideradas por 'Calarcá', fueron responsabilizadas del ataque durante operaciones militares de estabilidad. El Ejército Nacional condenó el acto como una grave violación a los derechos humanos y reafirmó su compromiso de proteger la población. Este incidente se produce en un corredor estratégico para grupos armados locales.

Noticia 3
Tito Franklin Escobar Ayllon, acusado de violar a una pasajera en 2015, comenzó su juicio en abril. Durante la audiencia, Escobar se disculpó pero evitó responder preguntas y no asistió a la declaración de la víctima. La abogada de la víctima considera sus palabras como una admisión de culpabilidad. El caso representa esperanza para Manuela Ponz, quien ha luchado por justicia durante años.

Noticia 4
Marlon Pérez, campeón mundial juvenil de ciclismo de pista en 1994, falleció tras ser asesinado con un arma blanca en Antioquia. Rigoberto Urán expresó su dolor por el trágico evento. La policía identificó a una persona conocida como 'Barbas' como la presunta agresora, quien compartió bebidas alcohólicas con Pérez antes del crimen. Las investigaciones sugieren que la riña pudo originarse bajo los efectos del alcohol.

Noticia 5
Dos sicarias planearon y ejecutaron el asesinato de Deyvi Jesús García Palomino en Piedecuesta, Santander, utilizando una zona rural como escenario para dificultar la detección. Julieth Ojeda Rodríguez citó a la víctima mientras Paula Valentina Joya coordinaba con los sicarios. Posteriormente, las autoridades capturaron a ambas mujeres y revelaron que recibieron cuatro millones de pesos por el crimen. Este caso ilustra la planificación cuidadosa en crímenes contractuales y la complicidad femenina en actividades delictivas.

Noticia 6
Una mujer colombiana, Nancy Infante, falleció en un accidente de tráfico en Chicago mientras solicitaba asilo político en Estados Unidos. Su hija Geraldine informó que se encuentran recolectando fondos para repatriar el cuerpo a Colombia. El incidente ha dejado a la familia con el doloroso desafío de despedirse de Nancy, quien buscaba mejores oportunidades lejos de su país.

Noticia 7
La Policía Metropolitana de Bogotá y la SIJIN aplican extinción de dominio contra 20 bienes inmuebles y un establecimiento comercial relacionados con el hurto de celulares. La investigación, que duró seis meses, implicó a una red que también cometió receptación y manipulación de equipos móviles en varias localidades de Bogotá. Estos bienes, valorados en 14.970 millones de pesos, fueron puestos a disposición de la SAE. La Policía advierte a los ciudadanos sobre la compra de dispositivos móviles no autorizados para evitar adquirir artículos robados.

Noticia 8
El gobernador Rodrigo Villalba Mosquera denunció un cruento ataque de disidencias de las Farc en Nátaga, Huila, donde murieron dos policías y resultaron heridos otros. Rechazó el regreso a la violencia y pidió refuerzos al gobierno nacional para mejorar la seguridad en el departamento. Villalba considera que la situación es crítica tras muertes colectivas en municipios cercanos. En un consejo de seguridad, se comprometió a implementar un Comando Especial Antiextorsión y un grupo de reacción rápida en La Plata.

Noticia 9
Claudia Sheinbaum presentó el plan de seguridad nacional de México con el objetivo de abordar la violencia criminosa que deja alrededor de 30.000 asesinatos anuales, sin recurrir a una "guerra contra el narcotráfico". La mandataria prometió fortalecer programas sociales para jóvenes y enfocarse en prevención y inteligencia. Este plan se implementa tras la decapitación del alcalde de Chilpancingo y en medio de un aumento de violencia en varios estados, incluyendo enfrentamientos entre carteles de droga. El secretario de Seguridad, Omar García Harfuch, anunció cuatro ejes principales: atención a las causas de la violencia, fortalecimiento de la Guardia Nacional, uso de inteligencia y coordinación interinstitucional.

Noticia 10
Un joven ciclista fue víctima de un violento asalto mientras transcurría por el puente NQS en Bogotá, resultando herido y perdiendo su bicicleta. El padre del joven expresó su preocupación sobre la falta de seguridad en esa zona. La pérdida afecta al sueño deportivo del joven, quien estaba a punto de participar en un circuito profesional. Las autoridades solicitan ayuda para capturar a los tres jóvenes armados y recuperar el medio de transporte. Este incidente refleja la persistente inseguridad en ciertas áreas de Bogotá, especialmente durante las noches.

Noticia 11
El director de la cárcel de máxima seguridad de Palogordo ha recibido nuevas amenazas de muerte por parte de un recluso del patio 10, exigiendo el cierre del área y acusando a las autoridades de abuso. Estas amenazas, divulgadas en un video, han llevado al Inpec a intensificar los controles de seguridad. El director ha solicitado medidas de protección a la Unidad Nacional de Protección ante la gravedad de las amenazas, mientras defiende las acciones realizadas en el penal.

Noticia 12
La Policía Metropolitana de Cali esclareció tres casos de homicidio ocurridos en diferentes barrios de la ciudad durante mayo pasado. Las capturas se realizaron tras una investigación minuciosa que incluyó seguimientos de cámaras de seguridad y denuncias ciudadanas, resultando en la detención de tres hombres关联问题：这段新闻的主要事件是什么？主要涉及哪些人物或实体？这一事件可能带来什么影响？

Assistant
1. 事件核心：哥伦比亚卡利市警方成功破获了5月发生在该市不同区域的三起谋杀案，并逮捕了涉案嫌疑人。
2. 主要人物及反应：卡利市警察局局长科尔尼奥·奥维多表示，通过细致调查和市民提供的信息，警方最终将三名犯罪嫌疑人绳之以法。被捕者包括“Km”、“Yanini”（曾因八起谋杀案在监狱中）以及一名20岁的男子“El cantante”。奥维多还提到，在今年卡利及其周边地区已逮捕378人涉嫌谋杀，并成功破获至少30%的杀人案件。
3. 影响：此次事件有助于提高当地居民的安全感，同时也展示了警方在打击犯罪方面的努力和成效。长期来看，这可能促使政府进一步加强社区监控与预防措施。
4. 附加背景信息：卡利市近期治安问题频发，包括儿童虐待、非法武器持有等案件，这些都反映了该地区社会安全形势的严峻性。

Noticia 13
Un repartidor arrojándose desde su balcón para evitar que le roben su moto sufrió graves heridas. Dos delincuentes intentaron hurtar el vehículo, pero fueron frustrados por Luis Escalada, quien cayó al pavimento durante la acción desesperada. A pesar de las lesiones en la cadera y los pulmones, los ladrones huyeron sin llevarse la moto. La familia lanzó una campaña para recaudar fondos para una prótesis costosa, ya que Escalada depende de su moto como herramienta de trabajo.

Noticia 14
El líder social y gestor cultural Andrés Erazo fue asesinado en Argelia, Cauca. Familiares y amigos expresaron su tristeza por la pérdida. El hecho se suma a un contexto de violencia contra líderes sociales en el departamento, donde desde 2016 han sido asesinados 19. Por otro lado, la firmante de paz Flor Elvia Güengue y sus escoltas fueron encontrados vivos después de ser secuestrados por grupos armados al margen de la ley en El Tambo.

Noticia 15
Un nuevo asesinato en la vía entre Yondó (Antioquia) y Cantagallo (Bolívar) ha sacudido el Magdalena Medio, atribuido a integrantes del Clan del Golfo. Entre las víctimas figuran dos líderes sociales y un excombatiente no identificado. El secretario de seguridad de Bolívar, Manuel Berrio, informó que los atacantes también heririeron a un hombre, quien fue auxiliado por el presidente de la junta de acción comunal pero posteriormente asesinado. Las autoridades aún no pueden levantar los cuerpos debido a las difíciles condiciones de seguridad en la zona. Este evento refleja el recrudecimiento de los enfrentamientos entre ELN y Clan del Golfo, afectando a civiles en la región.


Respuesta LLM:
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mConnectError[0m                              Traceback (most recent call last)
File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_transports/default.py:72[0m, in [0;36mmap_httpcore_exceptions[0;34m()[0m
[1;32m     71[0m [38;5;28;01mtry[39;00m:
[0;32m---> 72[0m     [38;5;28;01myield[39;00m
[1;32m     73[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m exc:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_transports/default.py:236[0m, in [0;36mHTTPTransport.handle_request[0;34m(self, request)[0m
[1;32m    235[0m [38;5;28;01mwith[39;00m map_httpcore_exceptions():
[0;32m--> 236[0m     resp [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_pool[49m[38;5;241;43m.[39;49m[43mhandle_request[49m[43m([49m[43mreq[49m[43m)[49m
[1;32m    238[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(resp[38;5;241m.[39mstream, typing[38;5;241m.[39mIterable)

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_sync/connection_pool.py:216[0m, in [0;36mConnectionPool.handle_request[0;34m(self, request)[0m
[1;32m    215[0m     [38;5;28mself[39m[38;5;241m.[39m_close_connections(closing)
[0;32m--> 216[0m     [38;5;28;01mraise[39;00m exc [38;5;28;01mfrom[39;00m [38;5;28;01mNone[39;00m
[1;32m    218[0m [38;5;66;03m# Return the response. Note that in this case we still have to manage[39;00m
[1;32m    219[0m [38;5;66;03m# the point at which the response is closed.[39;00m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_sync/connection_pool.py:196[0m, in [0;36mConnectionPool.handle_request[0;34m(self, request)[0m
[1;32m    194[0m [38;5;28;01mtry[39;00m:
[1;32m    195[0m     [38;5;66;03m# Send the request on the assigned connection.[39;00m
[0;32m--> 196[0m     response [38;5;241m=[39m [43mconnection[49m[38;5;241;43m.[39;49m[43mhandle_request[49m[43m([49m
[1;32m    197[0m [43m        [49m[43mpool_request[49m[38;5;241;43m.[39;49m[43mrequest[49m
[1;32m    198[0m [43m    [49m[43m)[49m
[1;32m    199[0m [38;5;28;01mexcept[39;00m ConnectionNotAvailable:
[1;32m    200[0m     [38;5;66;03m# In some cases a connection may initially be available to[39;00m
[1;32m    201[0m     [38;5;66;03m# handle a request, but then become unavailable.[39;00m
[1;32m    202[0m     [38;5;66;03m#[39;00m
[1;32m    203[0m     [38;5;66;03m# In this case we clear the connection and try again.[39;00m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_sync/connection.py:99[0m, in [0;36mHTTPConnection.handle_request[0;34m(self, request)[0m
[1;32m     98[0m     [38;5;28mself[39m[38;5;241m.[39m_connect_failed [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m---> 99[0m     [38;5;28;01mraise[39;00m exc
[1;32m    101[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_connection[38;5;241m.[39mhandle_request(request)

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_sync/connection.py:76[0m, in [0;36mHTTPConnection.handle_request[0;34m(self, request)[0m
[1;32m     75[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_connection [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m---> 76[0m     stream [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_connect[49m[43m([49m[43mrequest[49m[43m)[49m
[1;32m     78[0m     ssl_object [38;5;241m=[39m stream[38;5;241m.[39mget_extra_info([38;5;124m"[39m[38;5;124mssl_object[39m[38;5;124m"[39m)

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_sync/connection.py:122[0m, in [0;36mHTTPConnection._connect[0;34m(self, request)[0m
[1;32m    121[0m [38;5;28;01mwith[39;00m Trace([38;5;124m"[39m[38;5;124mconnect_tcp[39m[38;5;124m"[39m, logger, request, kwargs) [38;5;28;01mas[39;00m trace:
[0;32m--> 122[0m     stream [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_network_backend[49m[38;5;241;43m.[39;49m[43mconnect_tcp[49m[43m([49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    123[0m     trace[38;5;241m.[39mreturn_value [38;5;241m=[39m stream

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_backends/sync.py:205[0m, in [0;36mSyncBackend.connect_tcp[0;34m(self, host, port, timeout, local_address, socket_options)[0m
[1;32m    200[0m exc_map: ExceptionMapping [38;5;241m=[39m {
[1;32m    201[0m     socket[38;5;241m.[39mtimeout: ConnectTimeout,
[1;32m    202[0m     [38;5;167;01mOSError[39;00m: ConnectError,
[1;32m    203[0m }
[0;32m--> 205[0m [38;5;28;01mwith[39;00m map_exceptions(exc_map):
[1;32m    206[0m     sock [38;5;241m=[39m socket[38;5;241m.[39mcreate_connection(
[1;32m    207[0m         address,
[1;32m    208[0m         timeout,
[1;32m    209[0m         source_address[38;5;241m=[39msource_address,
[1;32m    210[0m     )

File [0;32m/usr/lib/python3.10/contextlib.py:153[0m, in [0;36m_GeneratorContextManager.__exit__[0;34m(self, typ, value, traceback)[0m
[1;32m    152[0m [38;5;28;01mtry[39;00m:
[0;32m--> 153[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgen[49m[38;5;241;43m.[39;49m[43mthrow[49m[43m([49m[43mtyp[49m[43m,[49m[43m [49m[43mvalue[49m[43m,[49m[43m [49m[43mtraceback[49m[43m)[49m
[1;32m    154[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m [38;5;28;01mas[39;00m exc:
[1;32m    155[0m     [38;5;66;03m# Suppress StopIteration *unless* it's the same exception that[39;00m
[1;32m    156[0m     [38;5;66;03m# was passed to throw().  This prevents a StopIteration[39;00m
[1;32m    157[0m     [38;5;66;03m# raised inside the "with" statement from being suppressed.[39;00m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpcore/_exceptions.py:14[0m, in [0;36mmap_exceptions[0;34m(map)[0m
[1;32m     13[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(exc, from_exc):
[0;32m---> 14[0m         [38;5;28;01mraise[39;00m to_exc(exc) [38;5;28;01mfrom[39;00m [38;5;21;01mexc[39;00m
[1;32m     15[0m [38;5;28;01mraise[39;00m

[0;31mConnectError[0m: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

[0;31mConnectError[0m                              Traceback (most recent call last)
Cell [0;32mIn[20], line 5[0m
[1;32m      3[0m news_summary [38;5;241m=[39m get_text_sample_by_cluster(label_cluster, [38;5;241m15[39m)
[1;32m      4[0m [38;5;28mprint[39m([38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124mRespuesta LLM:[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m)
[0;32m----> 5[0m [38;5;28mprint[39m([43mget_topic_in_cluster[49m[43m([49m[43mnews_summary[49m[43m)[49m)

Cell [0;32mIn[19], line 46[0m, in [0;36mget_topic_in_cluster[0;34m(news, model_name)[0m
[1;32m     19[0m prompt_characterics [38;5;241m=[39m ChatPromptTemplate(
[1;32m     20[0m     [
[1;32m     21[0m         SystemMessagePromptTemplate[38;5;241m.[39mfrom_template(
[0;32m   (...)[0m
[1;32m     41[0m     ]
[1;32m     42[0m )
[1;32m     44[0m llm_chain [38;5;241m=[39m prompt_characterics [38;5;241m|[39m llm_ollama [38;5;241m|[39m StrOutputParser()
[0;32m---> 46[0m [38;5;28;01mreturn[39;00m [43mllm_chain[49m[38;5;241;43m.[39;49m[43minvoke[49m[43m([49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43mnews[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[43mnews[49m[43m}[49m[43m)[49m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/runnables/base.py:3022[0m, in [0;36mRunnableSequence.invoke[0;34m(self, input, config, **kwargs)[0m
[1;32m   3020[0m             [38;5;28minput[39m [38;5;241m=[39m context[38;5;241m.[39mrun(step[38;5;241m.[39minvoke, [38;5;28minput[39m, config, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m   3021[0m         [38;5;28;01melse[39;00m:
[0;32m-> 3022[0m             [38;5;28minput[39m [38;5;241m=[39m [43mcontext[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43mstep[49m[38;5;241;43m.[39;49m[43minvoke[49m[43m,[49m[43m [49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43mconfig[49m[43m)[49m
[1;32m   3023[0m [38;5;66;03m# finish the root run[39;00m
[1;32m   3024[0m [38;5;28;01mexcept[39;00m [38;5;167;01mBaseException[39;00m [38;5;28;01mas[39;00m e:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/language_models/chat_models.py:284[0m, in [0;36mBaseChatModel.invoke[0;34m(self, input, config, stop, **kwargs)[0m
[1;32m    273[0m [38;5;28;01mdef[39;00m [38;5;21minvoke[39m(
[1;32m    274[0m     [38;5;28mself[39m,
[1;32m    275[0m     [38;5;28minput[39m: LanguageModelInput,
[0;32m   (...)[0m
[1;32m    279[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m    280[0m ) [38;5;241m-[39m[38;5;241m>[39m BaseMessage:
[1;32m    281[0m     config [38;5;241m=[39m ensure_config(config)
[1;32m    282[0m     [38;5;28;01mreturn[39;00m cast(
[1;32m    283[0m         ChatGeneration,
[0;32m--> 284[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgenerate_prompt[49m[43m([49m
[1;32m    285[0m [43m            [49m[43m[[49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_convert_input[49m[43m([49m[38;5;28;43minput[39;49m[43m)[49m[43m][49m[43m,[49m
[1;32m    286[0m [43m            [49m[43mstop[49m[38;5;241;43m=[39;49m[43mstop[49m[43m,[49m
[1;32m    287[0m [43m            [49m[43mcallbacks[49m[38;5;241;43m=[39;49m[43mconfig[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mcallbacks[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m    288[0m [43m            [49m[43mtags[49m[38;5;241;43m=[39;49m[43mconfig[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mtags[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m    289[0m [43m            [49m[43mmetadata[49m[38;5;241;43m=[39;49m[43mconfig[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mmetadata[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m    290[0m [43m            [49m[43mrun_name[49m[38;5;241;43m=[39;49m[43mconfig[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mrun_name[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m    291[0m [43m            [49m[43mrun_id[49m[38;5;241;43m=[39;49m[43mconfig[49m[38;5;241;43m.[39;49m[43mpop[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mrun_id[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m)[49m[43m,[49m
[1;32m    292[0m [43m            [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    293[0m [43m        [49m[43m)[49m[38;5;241m.[39mgenerations[[38;5;241m0[39m][[38;5;241m0[39m],
[1;32m    294[0m     )[38;5;241m.[39mmessage

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/language_models/chat_models.py:784[0m, in [0;36mBaseChatModel.generate_prompt[0;34m(self, prompts, stop, callbacks, **kwargs)[0m
[1;32m    776[0m [38;5;28;01mdef[39;00m [38;5;21mgenerate_prompt[39m(
[1;32m    777[0m     [38;5;28mself[39m,
[1;32m    778[0m     prompts: [38;5;28mlist[39m[PromptValue],
[0;32m   (...)[0m
[1;32m    781[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m    782[0m ) [38;5;241m-[39m[38;5;241m>[39m LLMResult:
[1;32m    783[0m     prompt_messages [38;5;241m=[39m [p[38;5;241m.[39mto_messages() [38;5;28;01mfor[39;00m p [38;5;129;01min[39;00m prompts]
[0;32m--> 784[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgenerate[49m[43m([49m[43mprompt_messages[49m[43m,[49m[43m [49m[43mstop[49m[38;5;241;43m=[39;49m[43mstop[49m[43m,[49m[43m [49m[43mcallbacks[49m[38;5;241;43m=[39;49m[43mcallbacks[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/language_models/chat_models.py:641[0m, in [0;36mBaseChatModel.generate[0;34m(self, messages, stop, callbacks, tags, metadata, run_name, run_id, **kwargs)[0m
[1;32m    639[0m         [38;5;28;01mif[39;00m run_managers:
[1;32m    640[0m             run_managers[i][38;5;241m.[39mon_llm_error(e, response[38;5;241m=[39mLLMResult(generations[38;5;241m=[39m[]))
[0;32m--> 641[0m         [38;5;28;01mraise[39;00m e
[1;32m    642[0m flattened_outputs [38;5;241m=[39m [
[1;32m    643[0m     LLMResult(generations[38;5;241m=[39m[res[38;5;241m.[39mgenerations], llm_output[38;5;241m=[39mres[38;5;241m.[39mllm_output)  [38;5;66;03m# type: ignore[list-item][39;00m
[1;32m    644[0m     [38;5;28;01mfor[39;00m res [38;5;129;01min[39;00m results
[1;32m    645[0m ]
[1;32m    646[0m llm_output [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_combine_llm_outputs([res[38;5;241m.[39mllm_output [38;5;28;01mfor[39;00m res [38;5;129;01min[39;00m results])

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/language_models/chat_models.py:631[0m, in [0;36mBaseChatModel.generate[0;34m(self, messages, stop, callbacks, tags, metadata, run_name, run_id, **kwargs)[0m
[1;32m    628[0m [38;5;28;01mfor[39;00m i, m [38;5;129;01min[39;00m [38;5;28menumerate[39m(messages):
[1;32m    629[0m     [38;5;28;01mtry[39;00m:
[1;32m    630[0m         results[38;5;241m.[39mappend(
[0;32m--> 631[0m             [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_generate_with_cache[49m[43m([49m
[1;32m    632[0m [43m                [49m[43mm[49m[43m,[49m
[1;32m    633[0m [43m                [49m[43mstop[49m[38;5;241;43m=[39;49m[43mstop[49m[43m,[49m
[1;32m    634[0m [43m                [49m[43mrun_manager[49m[38;5;241;43m=[39;49m[43mrun_managers[49m[43m[[49m[43mi[49m[43m][49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mrun_managers[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m
[1;32m    635[0m [43m                [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    636[0m [43m            [49m[43m)[49m
[1;32m    637[0m         )
[1;32m    638[0m     [38;5;28;01mexcept[39;00m [38;5;167;01mBaseException[39;00m [38;5;28;01mas[39;00m e:
[1;32m    639[0m         [38;5;28;01mif[39;00m run_managers:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_core/language_models/chat_models.py:853[0m, in [0;36mBaseChatModel._generate_with_cache[0;34m(self, messages, stop, run_manager, **kwargs)[0m
[1;32m    851[0m [38;5;28;01melse[39;00m:
[1;32m    852[0m     [38;5;28;01mif[39;00m inspect[38;5;241m.[39msignature([38;5;28mself[39m[38;5;241m.[39m_generate)[38;5;241m.[39mparameters[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mrun_manager[39m[38;5;124m"[39m):
[0;32m--> 853[0m         result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_generate[49m[43m([49m
[1;32m    854[0m [43m            [49m[43mmessages[49m[43m,[49m[43m [49m[43mstop[49m[38;5;241;43m=[39;49m[43mstop[49m[43m,[49m[43m [49m[43mrun_manager[49m[38;5;241;43m=[39;49m[43mrun_manager[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m
[1;32m    855[0m [43m        [49m[43m)[49m
[1;32m    856[0m     [38;5;28;01melse[39;00m:
[1;32m    857[0m         result [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_generate(messages, stop[38;5;241m=[39mstop, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_ollama/chat_models.py:644[0m, in [0;36mChatOllama._generate[0;34m(self, messages, stop, run_manager, **kwargs)[0m
[1;32m    637[0m [38;5;28;01mdef[39;00m [38;5;21m_generate[39m(
[1;32m    638[0m     [38;5;28mself[39m,
[1;32m    639[0m     messages: List[BaseMessage],
[0;32m   (...)[0m
[1;32m    642[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m    643[0m ) [38;5;241m-[39m[38;5;241m>[39m ChatResult:
[0;32m--> 644[0m     final_chunk [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_chat_stream_with_aggregation[49m[43m([49m
[1;32m    645[0m [43m        [49m[43mmessages[49m[43m,[49m[43m [49m[43mstop[49m[43m,[49m[43m [49m[43mrun_manager[49m[43m,[49m[43m [49m[43mverbose[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mverbose[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m
[1;32m    646[0m [43m    [49m[43m)[49m
[1;32m    647[0m     generation_info [38;5;241m=[39m final_chunk[38;5;241m.[39mgeneration_info
[1;32m    648[0m     chat_generation [38;5;241m=[39m ChatGeneration(
[1;32m    649[0m         message[38;5;241m=[39mAIMessage(
[1;32m    650[0m             content[38;5;241m=[39mfinal_chunk[38;5;241m.[39mtext,
[0;32m   (...)[0m
[1;32m    654[0m         generation_info[38;5;241m=[39mgeneration_info,
[1;32m    655[0m     )

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_ollama/chat_models.py:545[0m, in [0;36mChatOllama._chat_stream_with_aggregation[0;34m(self, messages, stop, run_manager, verbose, **kwargs)[0m
[1;32m    536[0m [38;5;28;01mdef[39;00m [38;5;21m_chat_stream_with_aggregation[39m(
[1;32m    537[0m     [38;5;28mself[39m,
[1;32m    538[0m     messages: List[BaseMessage],
[0;32m   (...)[0m
[1;32m    542[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m    543[0m ) [38;5;241m-[39m[38;5;241m>[39m ChatGenerationChunk:
[1;32m    544[0m     final_chunk [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m--> 545[0m     [38;5;28;01mfor[39;00m stream_resp [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39m_create_chat_stream(messages, stop, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    546[0m         [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(stream_resp, [38;5;28mstr[39m):
[1;32m    547[0m             chunk [38;5;241m=[39m ChatGenerationChunk(
[1;32m    548[0m                 message[38;5;241m=[39mAIMessageChunk(
[1;32m    549[0m                     content[38;5;241m=[39m(
[0;32m   (...)[0m
[1;32m    562[0m                 ),
[1;32m    563[0m             )

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/langchain_ollama/chat_models.py:527[0m, in [0;36mChatOllama._create_chat_stream[0;34m(self, messages, stop, **kwargs)[0m
[1;32m    517[0m     [38;5;28;01myield[39;00m [38;5;28mself[39m[38;5;241m.[39m_client[38;5;241m.[39mchat(
[1;32m    518[0m         model[38;5;241m=[39mparams[[38;5;124m"[39m[38;5;124mmodel[39m[38;5;124m"[39m],
[1;32m    519[0m         messages[38;5;241m=[39mollama_messages,
[0;32m   (...)[0m
[1;32m    524[0m         tools[38;5;241m=[39mkwargs[[38;5;124m"[39m[38;5;124mtools[39m[38;5;124m"[39m],
[1;32m    525[0m     )
[1;32m    526[0m [38;5;28;01melse[39;00m:
[0;32m--> 527[0m     [38;5;28;01myield from[39;00m [38;5;28mself[39m[38;5;241m.[39m_client[38;5;241m.[39mchat(
[1;32m    528[0m         model[38;5;241m=[39mparams[[38;5;124m"[39m[38;5;124mmodel[39m[38;5;124m"[39m],
[1;32m    529[0m         messages[38;5;241m=[39mollama_messages,
[1;32m    530[0m         stream[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    531[0m         options[38;5;241m=[39mOptions([38;5;241m*[39m[38;5;241m*[39mparams[[38;5;124m"[39m[38;5;124moptions[39m[38;5;124m"[39m]),
[1;32m    532[0m         keep_alive[38;5;241m=[39mparams[[38;5;124m"[39m[38;5;124mkeep_alive[39m[38;5;124m"[39m],
[1;32m    533[0m         [38;5;28mformat[39m[38;5;241m=[39mparams[[38;5;124m"[39m[38;5;124mformat[39m[38;5;124m"[39m],
[1;32m    534[0m     )

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/ollama/_client.py:80[0m, in [0;36mClient._stream[0;34m(self, method, url, **kwargs)[0m
[1;32m     79[0m [38;5;28;01mdef[39;00m [38;5;21m_stream[39m([38;5;28mself[39m, method: [38;5;28mstr[39m, url: [38;5;28mstr[39m, [38;5;241m*[39m[38;5;241m*[39mkwargs) [38;5;241m-[39m[38;5;241m>[39m Iterator[Mapping[[38;5;28mstr[39m, Any]]:
[0;32m---> 80[0m   [38;5;28;01mwith[39;00m [38;5;28mself[39m[38;5;241m.[39m_client[38;5;241m.[39mstream(method, url, [38;5;241m*[39m[38;5;241m*[39mkwargs) [38;5;28;01mas[39;00m r:
[1;32m     81[0m     [38;5;28;01mtry[39;00m:
[1;32m     82[0m       r[38;5;241m.[39mraise_for_status()

File [0;32m/usr/lib/python3.10/contextlib.py:135[0m, in [0;36m_GeneratorContextManager.__enter__[0;34m(self)[0m
[1;32m    133[0m [38;5;28;01mdel[39;00m [38;5;28mself[39m[38;5;241m.[39margs, [38;5;28mself[39m[38;5;241m.[39mkwds, [38;5;28mself[39m[38;5;241m.[39mfunc
[1;32m    134[0m [38;5;28;01mtry[39;00m:
[0;32m--> 135[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgen[49m[43m)[49m
[1;32m    136[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m    137[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m"[39m[38;5;124mgenerator didn[39m[38;5;124m'[39m[38;5;124mt yield[39m[38;5;124m"[39m) [38;5;28;01mfrom[39;00m [38;5;28;01mNone[39;00m

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_client.py:880[0m, in [0;36mClient.stream[0;34m(self, method, url, content, data, files, json, params, headers, cookies, auth, follow_redirects, timeout, extensions)[0m
[1;32m    857[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m    858[0m [38;5;124;03mAlternative to `httpx.request()` that streams the response body[39;00m
[1;32m    859[0m [38;5;124;03minstead of loading it into memory at once.[39;00m
[0;32m   (...)[0m
[1;32m    865[0m [38;5;124;03m[0]: /quickstart#streaming-responses[39;00m
[1;32m    866[0m [38;5;124;03m"""[39;00m
[1;32m    867[0m request [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mbuild_request(
[1;32m    868[0m     method[38;5;241m=[39mmethod,
[1;32m    869[0m     url[38;5;241m=[39murl,
[0;32m   (...)[0m
[1;32m    878[0m     extensions[38;5;241m=[39mextensions,
[1;32m    879[0m )
[0;32m--> 880[0m response [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msend[49m[43m([49m
[1;32m    881[0m [43m    [49m[43mrequest[49m[38;5;241;43m=[39;49m[43mrequest[49m[43m,[49m
[1;32m    882[0m [43m    [49m[43mauth[49m[38;5;241;43m=[39;49m[43mauth[49m[43m,[49m
[1;32m    883[0m [43m    [49m[43mfollow_redirects[49m[38;5;241;43m=[39;49m[43mfollow_redirects[49m[43m,[49m
[1;32m    884[0m [43m    [49m[43mstream[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    885[0m [43m[49m[43m)[49m
[1;32m    886[0m [38;5;28;01mtry[39;00m:
[1;32m    887[0m     [38;5;28;01myield[39;00m response

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_client.py:926[0m, in [0;36mClient.send[0;34m(self, request, stream, auth, follow_redirects)[0m
[1;32m    922[0m [38;5;28mself[39m[38;5;241m.[39m_set_timeout(request)
[1;32m    924[0m auth [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_build_request_auth(request, auth)
[0;32m--> 926[0m response [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_send_handling_auth[49m[43m([49m
[1;32m    927[0m [43m    [49m[43mrequest[49m[43m,[49m
[1;32m    928[0m [43m    [49m[43mauth[49m[38;5;241;43m=[39;49m[43mauth[49m[43m,[49m
[1;32m    929[0m [43m    [49m[43mfollow_redirects[49m[38;5;241;43m=[39;49m[43mfollow_redirects[49m[43m,[49m
[1;32m    930[0m [43m    [49m[43mhistory[49m[38;5;241;43m=[39;49m[43m[[49m[43m][49m[43m,[49m
[1;32m    931[0m [43m[49m[43m)[49m
[1;32m    932[0m [38;5;28;01mtry[39;00m:
[1;32m    933[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m stream:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_client.py:954[0m, in [0;36mClient._send_handling_auth[0;34m(self, request, auth, follow_redirects, history)[0m
[1;32m    951[0m request [38;5;241m=[39m [38;5;28mnext[39m(auth_flow)
[1;32m    953[0m [38;5;28;01mwhile[39;00m [38;5;28;01mTrue[39;00m:
[0;32m--> 954[0m     response [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_send_handling_redirects[49m[43m([49m
[1;32m    955[0m [43m        [49m[43mrequest[49m[43m,[49m
[1;32m    956[0m [43m        [49m[43mfollow_redirects[49m[38;5;241;43m=[39;49m[43mfollow_redirects[49m[43m,[49m
[1;32m    957[0m [43m        [49m[43mhistory[49m[38;5;241;43m=[39;49m[43mhistory[49m[43m,[49m
[1;32m    958[0m [43m    [49m[43m)[49m
[1;32m    959[0m     [38;5;28;01mtry[39;00m:
[1;32m    960[0m         [38;5;28;01mtry[39;00m:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_client.py:991[0m, in [0;36mClient._send_handling_redirects[0;34m(self, request, follow_redirects, history)[0m
[1;32m    988[0m [38;5;28;01mfor[39;00m hook [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39m_event_hooks[[38;5;124m"[39m[38;5;124mrequest[39m[38;5;124m"[39m]:
[1;32m    989[0m     hook(request)
[0;32m--> 991[0m response [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_send_single_request[49m[43m([49m[43mrequest[49m[43m)[49m
[1;32m    992[0m [38;5;28;01mtry[39;00m:
[1;32m    993[0m     [38;5;28;01mfor[39;00m hook [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39m_event_hooks[[38;5;124m"[39m[38;5;124mresponse[39m[38;5;124m"[39m]:

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_client.py:1027[0m, in [0;36mClient._send_single_request[0;34m(self, request)[0m
[1;32m   1022[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(
[1;32m   1023[0m         [38;5;124m"[39m[38;5;124mAttempted to send an async request with a sync Client instance.[39m[38;5;124m"[39m
[1;32m   1024[0m     )
[1;32m   1026[0m [38;5;28;01mwith[39;00m request_context(request[38;5;241m=[39mrequest):
[0;32m-> 1027[0m     response [38;5;241m=[39m [43mtransport[49m[38;5;241;43m.[39;49m[43mhandle_request[49m[43m([49m[43mrequest[49m[43m)[49m
[1;32m   1029[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(response[38;5;241m.[39mstream, SyncByteStream)
[1;32m   1031[0m response[38;5;241m.[39mrequest [38;5;241m=[39m request

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_transports/default.py:235[0m, in [0;36mHTTPTransport.handle_request[0;34m(self, request)[0m
[1;32m    221[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(request[38;5;241m.[39mstream, SyncByteStream)
[1;32m    223[0m req [38;5;241m=[39m httpcore[38;5;241m.[39mRequest(
[1;32m    224[0m     method[38;5;241m=[39mrequest[38;5;241m.[39mmethod,
[1;32m    225[0m     url[38;5;241m=[39mhttpcore[38;5;241m.[39mURL(
[0;32m   (...)[0m
[1;32m    233[0m     extensions[38;5;241m=[39mrequest[38;5;241m.[39mextensions,
[1;32m    234[0m )
[0;32m--> 235[0m [38;5;28;01mwith[39;00m map_httpcore_exceptions():
[1;32m    236[0m     resp [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_pool[38;5;241m.[39mhandle_request(req)
[1;32m    238[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(resp[38;5;241m.[39mstream, typing[38;5;241m.[39mIterable)

File [0;32m/usr/lib/python3.10/contextlib.py:153[0m, in [0;36m_GeneratorContextManager.__exit__[0;34m(self, typ, value, traceback)[0m
[1;32m    151[0m     value [38;5;241m=[39m typ()
[1;32m    152[0m [38;5;28;01mtry[39;00m:
[0;32m--> 153[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgen[49m[38;5;241;43m.[39;49m[43mthrow[49m[43m([49m[43mtyp[49m[43m,[49m[43m [49m[43mvalue[49m[43m,[49m[43m [49m[43mtraceback[49m[43m)[49m
[1;32m    154[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m [38;5;28;01mas[39;00m exc:
[1;32m    155[0m     [38;5;66;03m# Suppress StopIteration *unless* it's the same exception that[39;00m
[1;32m    156[0m     [38;5;66;03m# was passed to throw().  This prevents a StopIteration[39;00m
[1;32m    157[0m     [38;5;66;03m# raised inside the "with" statement from being suppressed.[39;00m
[1;32m    158[0m     [38;5;28;01mreturn[39;00m exc [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m value

File [0;32m~/github_public/Metodos-Estadisticos/venv/lib/python3.10/site-packages/httpx/_transports/default.py:89[0m, in [0;36mmap_httpcore_exceptions[0;34m()[0m
[1;32m     86[0m     [38;5;28;01mraise[39;00m
[1;32m     88[0m message [38;5;241m=[39m [38;5;28mstr[39m(exc)
[0;32m---> 89[0m [38;5;28;01mraise[39;00m mapped_exc(message) [38;5;28;01mfrom[39;00m [38;5;21;01mexc[39;00m

[0;31mConnectError[0m: [Errno 111] Connection refused

